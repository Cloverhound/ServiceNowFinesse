/*! RESOURCE: /scripts/openframe/1.0.1/openFrameAPI.min.js */
/*! openFrameAPI v1.0.1 | (c) 2014-2016 [ServiceNow], All Rights Reserved */
var SNC=window.SNC||{};SNC.DataValidation=function(){function d(a,b){for(var c in a)if(a.hasOwnProperty(c)&&a[c]==b)return!0;return!1}function e(b,c,d){return"string"!=typeof b&&k("Input is incorrect. Only string is supported"),c&&d?b.length>d&&k("Length cannot be more than "+d):c&&b.length>a&&k("Length cannot be more than "+a),!0}function f(a){return("number"!=typeof a||a<0)&&k("Input is incorrect. Only number is supported and it should be greater than 0"),!0}function g(a){return null!=a&&"object"==typeof a||k("Input is incorrect. Only object is supported"),!0}function h(a){return!(a.length>b)}function i(a){for(var b=0;b<c.length;b++)a.indexOf(c[b])!=-1&&k("Url query string cannot have redirects");return!0}function j(a){return 1==/^(?:[a-z]+:)?\/\//i.test(a)&&k("Custom url cannot be absolute"),!0}function k(a){throw a}var a=256,b=4400,c=["sysparm_stack","sysparm_goto_url"];return{contains:d,stringValidation:e,numberValidation:f,objectValidation:g,objectSizeValidation:h,queryStringValidation:i,customURLValidation:j,throwError:k}}();var SNC=window.SNC||{};SNC.Communication=function(){function g(b,d){var f=!1;SNC.registeredPostMessageHandler||n(),e=decodeURIComponent(window.location.href.split("topDomain=")[1]);try{this.request(a.INIT,{},function(a){f||(f=!0,b(a))},d)}catch(a){f=!0,d(a)}setTimeout(function(){f||(f=!0,d("Openframe init request timed out"))},c)}function h(a,b){var c=d[a];c&&0!=c.length&&c.indexOf(b)!=-1&&c.splice(c.indexOf(b),1)}function i(c,d){var g,h,i="";f.contains(a,c)&&(h={type:b,eventName:c,args:d},top.postMessage?e?(g=JSON.stringify(h),f.objectSizeValidation(g)||(i="Message payload exceeds the supported limit")):i="The Top domain is undefined for cross domain messaging":i="Browser does not support cross domain messaging",i?m(a.COMMUNICATION_FAILURE,i):top.postMessage(g,e))}function j(a,b){var c=d[a];c||(c=[],d[a]=c),c.push(b)}function k(b,c,d,e){if(f.contains(a,b)){var g=b+"_"+(new Date).getTime()*Math.random(),k={},l=this;k.id=g,k.method=b,k.payload=c,i(a.REQUEST,k),j(a.RESPONSE,function(a){g==a.context.id&&(h(l.EVENTS.RESPONSE,arguments.callee),a.isSuccess?d(a.context.result):e(a.context.result))})}}function l(a,b){for(var c in a)if(a.hasOwnProperty(c)&&a[c]==b)return!0;return!1}function m(a,b){var e,c=d[a];if(c&&0!=c.length)for(e=0;e<c.length;++e){var f=c[e];f.call(null,b)}}function n(){window.postMessage&&(window.addEventListener("message",function(a){var c;try{c=JSON.parse(a.data)}catch(a){return}!c.type!=b&&m(c.eventName,c.args)},!1),SNC.registeredPostMessageHandler=!0)}var e,a={INIT:"openframe_init",SHOW:"openframe_show",HIDE:"openframe_hide",VISIBLE:"openframe_visible",REQUEST:"openframe_request",RESPONSE:"openframe_response",GET_CONFIG:"openframe_get_config",SET_SIZE:"openframe_set_size",SET_HEADER_TITLE:"openframe_set_header_title",SET_HEADER_TITLE_ICON:"openframe_set_header_title_icon",SET_HEADER_ICONS:"openframe_set_header_icons",SET_TOP_FRAME_URL:"openframe_set_top_frame_url",COMMUNICATION_FAILURE:"openframe_communication_failure"},b="NOW.PostMessage",c=3e3,d={},f=SNC.DataValidation;return{EVENTS:a,init:g,contains:l,publish:i,subscribe:j,request:k}}(),SNC.OpenFrame=function(){function f(a,b,c){d.init(function(){d.request(d.EVENTS.GET_CONFIG,a,b,c)},c)}function g(){d.publish(d.EVENTS.SHOW)}function h(){d.publish(d.EVENTS.HIDE)}function i(a,b){d.request(d.EVENTS.VISIBLE,{},a,b)}function j(a){e.stringValidation(a,!0)&&d.publish(d.EVENTS.SET_HEADER_TITLE,{title:a})}function k(a){e.stringValidation(a,!0)&&d.publish(d.EVENTS.SET_HEADER_TITLE,{subtitle:a})}function l(a,b){e.numberValidation(a)&&e.numberValidation(b)&&d.publish(d.EVENTS.SET_SIZE,{width:a,height:b})}function m(a){e.objectValidation(a)&&d.publish(d.EVENTS.SET_HEADER_TITLE_ICON,a)}function n(a){e.objectValidation(a)&&d.publish(d.EVENTS.SET_HEADER_ICONS,a)}function o(a,b){d.contains(this.EVENTS,a)?d.subscribe(a,b):e.throwError(a+" is not a valid event for subscription")}function p(a){e.objectValidation(a)&&a.query&&e.queryStringValidation(a.query)&&d.publish(d.EVENTS.SET_TOP_FRAME_URL,{form:a})}function q(a){e.objectValidation(a)&&a.query&&e.queryStringValidation(a.query)&&d.publish(d.EVENTS.SET_TOP_FRAME_URL,{list:a})}function r(a){var b={url:a};e.stringValidation(b.url,!0,2083)&&e.customURLValidation(b.url)&&d.publish(d.EVENTS.SET_TOP_FRAME_URL,{url:b})}function s(){return b}var a={HEADER_ICON_CLICKED:"openframe_header_icon_clicked",OPENFRAME_SHOWN:"openframe_shown",OPENFRAME_HIDDEN:"openframe_hidden",OPENFRAME_BEFORE_DESTROY:"openframe_before_destroy",COMMUNICATION_EVENT:"openframe_communication",COMMUNICATION_FAILURE:"openframe_communication_failure"},b="1.0.1",d=SNC.Communication,e=SNC.DataValidation;return{EVENTS:a,init:f,version:s,show:g,hide:h,isVisible:i,subscribe:o,setTitle:j,setSubtitle:k,setSize:l,setIcons:n,setTitleIcon:m,openServiceNowForm:p,openServiceNowList:q,openCustomURL:r}}();var openFrameAPI=SNC.OpenFrame;
