/*! RESOURCE: /scripts/openframe/1.0.0/openFrameAPI.min.js */
/*! openFrameAPI v1.0.0 | (c) 2014-2015 [ServiceNow], All Rights Reserved */
var SNC=window.SNC||{};SNC.DataValidation=function(){function e(e,n){for(var t in e)if(e.hasOwnProperty(t)&&e[t]==n)return!0;return!1}function n(e,n){return"string"!=typeof e&&a("Input is incorrect. Only string is supported"),n&&e.length>s&&a("Length cannot be more than "+s),!0}function t(e){return("number"!=typeof e||0>e)&&a("Input is incorrect. Only number is supported and it should be greater than 0"),!0}function i(e){return(null==e||"object"!=typeof e)&&a("Input is incorrect. Only object is supported"),!0}function o(e){return e.length>u?!1:!0}function r(e){for(var n=0;n<E.length;n++)-1!=e.indexOf(E[n])&&a("Url query string cannot have redirects");return!0}function a(e){throw e}var s=256,u=4400,E=["sysparm_stack","sysparm_goto_url"];return{contains:e,stringValidation:n,numberValidation:t,objectValidation:i,objectSizeValidation:o,queryStringValidation:r,throwError:a}}(),SNC.Communication=function(){function e(e,n){var t=!1;SNC.registeredPostMessageHandler||s(),u=decodeURIComponent(window.location.href.split("topDomain=")[1]);try{this.request(E.INIT,{},function(n){t||(t=!0,e(n))},n)}catch(i){t=!0,n(i)}setTimeout(function(){t||(t=!0,n("Openframe init request timed out"))},f)}function n(e,n){var t=_[e];t&&0!=t.length&&-1!=t.indexOf(n)&&t.splice(t.indexOf(n),1)}function t(e,n){var t,i,o="";l.contains(E,e)&&(i={type:c,eventName:e,args:n},top.postMessage?u?(t=JSON.stringify(i),l.objectSizeValidation(t)||(o="Message payload exceeds the supported limit")):o="The Top domain is undefined for cross domain messaging":o="Browser does not support cross domain messaging",o?a(E.COMMUNICATION_FAILURE,o):top.postMessage(t,u))}function i(e,n){var t=_[e];t||(t=[],_[e]=t),t.push(n)}function o(e,o,r,a){if(l.contains(E,e)){var s=e+"_"+(new Date).getTime()*Math.random(),u={},c=this;u.id=s,u.method=e,u.payload=o,t(E.REQUEST,u),i(E.RESPONSE,function(e){s==e.context.id&&(n(c.EVENTS.RESPONSE,arguments.callee),e.isSuccess?r(e.context.result):a(e.context.result))})}}function r(e,n){for(var t in e)if(e.hasOwnProperty(t)&&e[t]==n)return!0;return!1}function a(e,n){var t,i=_[e];if(i&&0!=i.length)for(t=0;t<i.length;++t){var o=i[t];o.call(null,n)}}function s(){window.postMessage&&(window.addEventListener("message",function(e){var n;try{n=JSON.parse(e.data)}catch(t){return}!n.type!=c&&a(n.eventName,n.args)},!1),SNC.registeredPostMessageHandler=!0)}var u,E={INIT:"openframe_init",SHOW:"openframe_show",HIDE:"openframe_hide",VISIBLE:"openframe_visible",REQUEST:"openframe_request",RESPONSE:"openframe_response",GET_CONFIG:"openframe_get_config",SET_SIZE:"openframe_set_size",SET_HEADER_TITLE:"openframe_set_header_title",SET_HEADER_TITLE_ICON:"openframe_set_header_title_icon",SET_HEADER_ICONS:"openframe_set_header_icons",SET_TOP_FRAME_URL:"openframe_set_top_frame_url",COMMUNICATION_FAILURE:"openframe_communication_failure"},c="NOW.PostMessage",f=3e3,_={},l=SNC.DataValidation;return{EVENTS:E,init:e,contains:r,publish:t,subscribe:i,request:o}}(),SNC.OpenFrame=function(){function e(e,n,t){d.init(function(){d.request(d.EVENTS.GET_CONFIG,e,n,t)},t)}function n(){d.publish(d.EVENTS.SHOW)}function t(){d.publish(d.EVENTS.HIDE)}function i(e,n){d.request(d.EVENTS.VISIBLE,{},e,n)}function o(e){S.stringValidation(e,!0)&&d.publish(d.EVENTS.SET_HEADER_TITLE,{title:e})}function r(e){S.stringValidation(e,!0)&&d.publish(d.EVENTS.SET_HEADER_TITLE,{subtitle:e})}function a(e,n){S.numberValidation(e)&&S.numberValidation(n)&&d.publish(d.EVENTS.SET_SIZE,{width:e,height:n})}function s(e){S.objectValidation(e)&&d.publish(d.EVENTS.SET_HEADER_TITLE_ICON,e)}function u(e){S.objectValidation(e)&&d.publish(d.EVENTS.SET_HEADER_ICONS,e)}function E(e,n){d.contains(this.EVENTS,e)?d.subscribe(e,n):S.throwError(e+" is not a valid event for subscription")}function c(e){S.objectValidation(e)&&e.query&&S.queryStringValidation(e.query)&&d.publish(d.EVENTS.SET_TOP_FRAME_URL,{form:e})}function f(e){S.objectValidation(e)&&e.query&&S.queryStringValidation(e.query)&&d.publish(d.EVENTS.SET_TOP_FRAME_URL,{list:e})}function _(){return p}var l={HEADER_ICON_CLICKED:"openframe_header_icon_clicked",OPENFRAME_SHOWN:"openframe_shown",OPENFRAME_HIDDEN:"openframe_hidden",OPENFRAME_BEFORE_DESTROY:"openframe_before_destroy",COMMUNICATION_EVENT:"openframe_communication",COMMUNICATION_FAILURE:"openframe_communication_failure"},p="1.0.0",d=SNC.Communication,S=SNC.DataValidation;return{EVENTS:l,init:e,version:_,show:n,hide:t,isVisible:i,subscribe:E,setTitle:o,setSubtitle:r,setSize:a,setIcons:u,setTitleIcon:s,openServiceNowForm:c,openServiceNowList:f}}();var openFrameAPI=SNC.OpenFrame;
