/*! RESOURCE: /scripts/openframe/1.0.2/openFrameAPI.min.js */
/*! openFrameAPI v1.0.2 | (c) 2014-2016 [ServiceNow], All Rights Reserved */
var SNC=window.SNC||{};SNC.DataValidation=function(){function n(n,e){for(var t in n)if(n.hasOwnProperty(t)&&n[t]==e)return!0;return!1}function e(n,e,t){return"string"!=typeof n&&s("Input is incorrect. Only string is supported"),e&&t?n.length>t&&s("Length cannot be more than "+t):e&&n.length>u&&s("Length cannot be more than "+u),!0}function t(n){return("number"!=typeof n||0>n)&&s("Input is incorrect. Only number is supported and it should be greater than 0"),!0}function i(n){return(null==n||"object"!=typeof n)&&s("Input is incorrect. Only object is supported"),!0}function o(n){return n.length>c?!1:!0}function r(n){for(var e=0;e<E.length;e++)-1!=n.indexOf(E[e])&&s("Url query string cannot have redirects");return!0}function a(n){return 1==/^(?:[a-z]+:)?\/\//i.test(n)&&s("Custom url cannot be absolute"),!0}function s(n){throw n}var u=256,c=4400,E=["sysparm_stack","sysparm_goto_url"];return{contains:n,stringValidation:e,numberValidation:t,objectValidation:i,objectSizeValidation:o,queryStringValidation:r,customURLValidation:a,throwError:s}}();var SNC=window.SNC||{};SNC.Communication=function(){function n(){SNC.registeredPostMessageHandler||c(),r(_,T)}function e(n,e){function i(){o>d?(clearInterval(a),E?t(r,n,e):e("Openframe init request timed out")):o++}var o=0,r=this,a=setInterval(function(){i()},S)}function t(n,e,t){var i=!1;try{n.request(f.INIT,{},function(n){i||(i=!0,e(n))},t)}catch(o){i=!0,t(o)}setTimeout(function(){i||(i=!0,t("Openframe init request timed out"))},p)}function i(n,e){var t=m[n];t&&0!=t.length&&-1!=t.indexOf(e)&&t.splice(t.indexOf(e),1)}function o(n,e){var t,i,o="";N.contains(f,n)&&(i={type:l,eventName:n,args:e},top.postMessage?E?(t=JSON.stringify(i),N.objectSizeValidation(t)||(o="Message payload exceeds the supported limit")):o="The Top domain is undefined for cross domain messaging":o="Browser does not support cross domain messaging",o?u(f.COMMUNICATION_FAILURE,o):top.postMessage(t,E))}function r(n,e){var t=m[n];t||(t=[],m[n]=t),t.push(e)}function a(n,e,t,a){if(N.contains(f,n)){var s=n+"_"+(new Date).getTime()*Math.random(),u={},c=this;u.id=s,u.method=n,u.payload=e,o(f.REQUEST,u),r(f.RESPONSE,function(n){s==n.context.id&&(i(c.EVENTS.RESPONSE,arguments.callee),n.isSuccess?t(n.context.result):a(n.context.result))})}}function s(n,e){for(var t in n)if(n.hasOwnProperty(t)&&n[t]==e)return!0;return!1}function u(n,e){var t,i=m[n];if(i&&0!=i.length)for(t=0;t<i.length;++t){var o=i[t];o.call(null,e)}}function c(){window.postMessage&&(window.addEventListener("message",function(n){var e;try{e=JSON.parse(n.data)}catch(t){return}!e.type!=l&&u(e.eventName,e.args)},!1),SNC.registeredPostMessageHandler=!0)}var E,f={INIT:"openframe_init",SHOW:"openframe_show",HIDE:"openframe_hide",VISIBLE:"openframe_visible",REQUEST:"openframe_request",RESPONSE:"openframe_response",GET_CONFIG:"openframe_get_config",SET_SIZE:"openframe_set_size",SET_HEADER_TITLE:"openframe_set_header_title",SET_HEADER_TITLE_ICON:"openframe_set_header_title_icon",SET_HEADER_ICONS:"openframe_set_header_icons",SET_TOP_FRAME_URL:"openframe_set_top_frame_url",COMMUNICATION_FAILURE:"openframe_communication_failure"},l="NOW.PostMessage",_="openframe_topframe_domain",p=3e3,S=1e3,d=5,m={},N=SNC.DataValidation,T=function(n){E=n.topDomain,i(_,T)};return n(),{EVENTS:f,init:e,contains:s,publish:o,subscribe:r,request:a}}(),SNC.OpenFrame=function(){function n(n,e,t){d.init(function(){d.request(d.EVENTS.GET_CONFIG,n,e,t)},t)}function e(){d.publish(d.EVENTS.SHOW)}function t(){d.publish(d.EVENTS.HIDE)}function i(n,e){d.request(d.EVENTS.VISIBLE,{},n,e)}function o(n){m.stringValidation(n,!0)&&d.publish(d.EVENTS.SET_HEADER_TITLE,{title:n})}function r(n){m.stringValidation(n,!0)&&d.publish(d.EVENTS.SET_HEADER_TITLE,{subtitle:n})}function a(n,e){m.numberValidation(n)&&m.numberValidation(e)&&d.publish(d.EVENTS.SET_SIZE,{width:n,height:e})}function s(n){m.objectValidation(n)&&d.publish(d.EVENTS.SET_HEADER_TITLE_ICON,n)}function u(n){m.objectValidation(n)&&d.publish(d.EVENTS.SET_HEADER_ICONS,n)}function c(n,e){d.contains(this.EVENTS,n)?d.subscribe(n,e):m.throwError(n+" is not a valid event for subscription")}function E(n){m.objectValidation(n)&&n.query&&m.queryStringValidation(n.query)&&d.publish(d.EVENTS.SET_TOP_FRAME_URL,{form:n})}function f(n){m.objectValidation(n)&&n.query&&m.queryStringValidation(n.query)&&d.publish(d.EVENTS.SET_TOP_FRAME_URL,{list:n})}function l(n){var e={url:n};m.stringValidation(e.url,!0,2083)&&m.customURLValidation(e.url)&&d.publish(d.EVENTS.SET_TOP_FRAME_URL,{url:e})}function _(){return S}var p={HEADER_ICON_CLICKED:"openframe_header_icon_clicked",OPENFRAME_SHOWN:"openframe_shown",OPENFRAME_HIDDEN:"openframe_hidden",OPENFRAME_BEFORE_DESTROY:"openframe_before_destroy",COMMUNICATION_EVENT:"openframe_communication",COMMUNICATION_FAILURE:"openframe_communication_failure"},S="1.0.2",d=SNC.Communication,m=SNC.DataValidation;return{EVENTS:p,init:n,version:_,show:e,hide:t,isVisible:i,subscribe:c,setTitle:o,setSubtitle:r,setSize:a,setIcons:u,setTitleIcon:s,openServiceNowForm:E,openServiceNowList:f,openCustomURL:l}}();var openFrameAPI=SNC.OpenFrame;
